<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <title>–ë–∞–≥—à–∏–π–Ω —Å–∞–º–±–∞—Ä</title>
</head>
<body>
  <h2>üìã –ë–∞–≥—à–∏–π–Ω —Å–∞–º–±–∞—Ä <span id="welcome"></span></h2>

  <section>
    <h3>üßë‚Äçüéì –ò—Ä—Ü –±“Ø—Ä—Ç–≥—ç—Ö</h3>
    <table>
      <thead>
        <tr><th>–ù—ç—Ä</th><th>–ò—Ä—Å—ç–Ω</th></tr>
      </thead>
      <tbody>
        <tr><td>–ë–∞—Ç-–≠—Ä–¥—ç–Ω—ç</td><td><input type="checkbox" class="attendance" data-name="–ë–∞—Ç-–≠—Ä–¥—ç–Ω—ç"></td></tr>
        <tr><td>–°–∞—Ä–∞–∞</td><td><input type="checkbox" class="attendance" data-name="–°–∞—Ä–∞–∞"></td></tr>
      </tbody>
    </table>
    <button onclick="saveAttendance()">–ò—Ä—Ü —Ö–∞–¥–≥–∞–ª–∞—Ö</button>
  </section>

  <section>
    <h3>üìö –î“Ø–Ω –æ—Ä—É—É–ª–∞—Ö</h3>
    <table>
      <thead>
        <tr><th>–ù—ç—Ä</th><th>–•–∏—á—ç—ç–ª</th><th>–î“Ø–Ω</th></tr>
      </thead>
      <tbody>
        <tr><td>–ë–∞—Ç-–≠—Ä–¥—ç–Ω—ç</td><td>–ú–∞—Ç–µ–º–∞—Ç–∏–∫</td><td><input type="number" class="grade" data-name="–ë–∞—Ç-–≠—Ä–¥—ç–Ω—ç" data-subject="–ú–∞—Ç–µ–º–∞—Ç–∏–∫"></td></tr>
        <tr><td>–°–∞—Ä–∞–∞</td><td>–ê–Ω–≥–ª–∏ —Ö—ç–ª</td><td><input type="number" class="grade" data-name="–°–∞—Ä–∞–∞" data-subject="–ê–Ω–≥–ª–∏ —Ö—ç–ª"></td></tr>
      </tbody>
    </table>
    <button onclick="saveGrades()">–î“Ø–Ω —Ö–∞–¥–≥–∞–ª–∞—Ö</button>
  </section>

  <script>
    const user = JSON.parse(localStorage.getItem("user"));
    if (!user || user.role !== "teacher") {
      alert("–•–∞–Ω–¥–∞—Ö —ç—Ä—Ö –±–∞–π—Ö–≥“Ø–π!");
      window.location.href = "login.html";
    } else {
      document.getElementById("welcome").textContent = "–ù—ç—Ä: " + user.name;
    }

    window.onload = function() {
      const attendanceData = JSON.parse(localStorage.getItem("attendance")) || {};
      document.querySelectorAll(".attendance").forEach(item => {
        item.checked = attendanceData[item.dataset.name] === "–ò—Ä—Å—ç–Ω";
      });

      const gradesData = JSON.parse(localStorage.getItem("grades")) || {};
      document.querySelectorAll(".grade").forEach(item => {
        const key = item.dataset.name + "-" + item.dataset.subject;
        item.value = gradesData[key] || "";
      });
    };

    function saveAttendance() {
      const attendances = {};
      document.querySelectorAll(".attendance").forEach(item => {
        attendances[item.dataset.name] = item.checked ? "–ò—Ä—Å—ç–Ω" : "–ò—Ä—ç—ç–≥“Ø–π";
      });
      localStorage.setItem("attendance", JSON.stringify(attendances));
      alert("–ò—Ä—Ü —Ö–∞–¥–≥–∞–ª–∞–≥–¥–ª–∞–∞");
    }

    function saveGrades() {
      const grades = {};
      document.querySelectorAll(".grade").forEach(item => {
        const key = item.dataset.name + "-" + item.dataset.subject;
        grades[key] = item.value;
      });
      localStorage.setItem("grades", JSON.stringify(grades));
      alert("–î“Ø–Ω —Ö–∞–¥–≥–∞–ª–∞–≥–¥–ª–∞–∞");
    }
  </script>
</body>
</html>
